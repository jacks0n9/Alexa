CC=arm-arago-linux-gnueabi-gcc
CFLAGS = -Wall -g
#NLLIBDIR = /root/libnl-1.1
#NLLIBNAME = libnl-1.1
LIBTCMD_DIR := ../libtcmd

LDLIBS += $(shell pkg-config --libs $(NLLIBNAME)) -lrt -ltcmd -lnl 
CFLAGS += $(shell pkg-config --cflags $(NLLIBNAME)) -I$(LIBTCMD_DIR) -L$(LIBTCMD_DIR) -L$(NLLIBDIR)/lib -I$(NLLIBDIR)/include

NLLIBNAME = libnl-1.1
WLAN_API = WLAN_API_NL80211
WLAN_API_SRCS = nl80211.c

SRCS = os.c $(WLAN_API_SRCS) libtcmd.c
OBJS = $(SRCS:.c=.o)

LDLIBS += $(shell pkg-config --libs $(NLLIBNAME)) -lrt
CFLAGS += $(shell pkg-config --cflags $(NLLIBNAME)) -D$(WLAN_API)

libtcmd.a: $(SRCS) $(OBJS)
	$(AR) rcs $@ $(OBJS)

$(OBJS): $(SRCS)
	$(CC) $(CFLAGS) -c $(@:.o=.c) -o $@ $(LDLIBS)

clean:
	rm -f *.a *.o
